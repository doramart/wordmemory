const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/WordLayout-D0VH2a69.js","js/useStudyMode-Cc2-78KI.js","js/vue-qqQgwo1J.js","js/vant-BwjjKKVX.js","css/vue-Dhje-ZXv.css","js/vendor-BZARPbSw.js","js/rolldown-runtime-K98o8HXg.js","css/vendor-Cn34xpDS.css","css/WordLayout-Bpxyn9lO.css","js/WordLearn-aDvHliN4.js","js/wordmemory-UTo84tZV.js","css/WordLearn-BvmOgAP7.css","js/WordManage-D8zVGHJw.js","css/WordManage-L9Qo8ZQ6.css","js/WordReview-DJgxGtp1.js","css/WordReview-BYqmaR90.css","js/Login-DhRWoI2Z.js","css/Login-B5sjKFQ1.css"])))=>i.map(i=>d[i]);
import{$ as e,A as t,B as n,G as r,H as i,J as a,L as o,M as s,N as c,O as l,P as u,Q as d,R as f,U as p,W as m,Y as h,at as g,b as _,et as v,it as y,j as b,k as x,nt as S,ot as C,q as w}from"./vue-qqQgwo1J.js";import{n as T}from"./vendor-BZARPbSw.js";(function(){let e=document.createElement(`link`).relList;if(e&&e.supports&&e.supports(`modulepreload`))return;for(let e of document.querySelectorAll(`link[rel="modulepreload"]`))n(e);new MutationObserver(e=>{for(let t of e)if(t.type===`childList`)for(let e of t.addedNodes)e.tagName===`LINK`&&e.rel===`modulepreload`&&n(e)}).observe(document,{childList:!0,subtree:!0});function t(e){let t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),e.crossOrigin===`use-credentials`?t.credentials=`include`:e.crossOrigin===`anonymous`?t.credentials=`omit`:t.credentials=`same-origin`,t}function n(e){if(e.ep)return;e.ep=!0;let n=t(e);fetch(e.href,n)}})();var E=T.create({baseURL:`/api`,timeout:3e4*10,headers:{"Content-Type":`application/json`}});E.interceptors.request.use(e=>{let t=localStorage.getItem(`pwa_auth_token`);return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e)),E.interceptors.response.use(e=>{let{data:t}=e;if(t.code&&t.code!==200&&t.code!==0){let e=t.message||`请求失败`;return _(e),Promise.reject(Error(e))}return t},e=>{let{response:t}=e;if(t){let{status:e,data:n}=t;switch(e){case 401:localStorage.removeItem(`pwa_auth_token`),localStorage.removeItem(`pwa_user_info`),window.location.href=`/login`;break;case 403:_(`没有权限访问`);break;case 404:_(`请求的资源不存在`);break;case 500:_(`服务器错误`);break;default:_(n?.message||`请求失败`)}}else _(`网络连接失败`);return Promise.reject(e)});var D=E;const O={sendCode(e){return D.post(`/auth/send-code`,{email:e})},login(e,t){return D.post(`/auth/login`,{email:e,code:t})},logout(){return D.post(`/auth/logout`)},getProfile(){return D.get(`/auth/profile`)},refreshToken(){return D.post(`/auth/refresh-token`)}};var k={TOKEN:`pwa_auth_token`,USER:`pwa_user_info`};const A=f(`user`,()=>{let e=g(null),t=g(null),n=g(!1),r=g(!1),i=p(()=>!!e.value&&!!t.value),a=p(()=>t.value?.email||``),o=p(()=>t.value?.nickname||t.value?.email?.split(`@`)[0]||``),s=p(()=>t.value?.avatar||``);async function c(){if(!r.value)try{let n=localStorage.getItem(k.TOKEN),r=localStorage.getItem(k.USER);if(n&&(e.value=n),r&&(t.value=JSON.parse(r)),e.value)try{t.value=(await O.getProfile()).data,m()}catch{h()}}finally{r.value=!0}}async function l(e){return(await O.sendCode(e)).data}async function u(r,i){n.value=!0;try{let n=await O.login(r,i);return e.value=n.data.token,t.value=n.data.user,m(),n.data}finally{n.value=!1}}async function d(){try{await O.logout()}catch{}finally{h()}}async function f(){try{let t=await O.refreshToken();return e.value=t.data.token,m(),t.data}catch{throw h(),Error(`Token 刷新失败`)}}function m(){e.value&&localStorage.setItem(k.TOKEN,e.value),t.value&&localStorage.setItem(k.USER,JSON.stringify(t.value))}function h(){e.value=null,t.value=null,localStorage.removeItem(k.TOKEN),localStorage.removeItem(k.USER)}return{token:e,user:t,loading:n,initialized:r,isLoggedIn:i,userEmail:a,userName:o,userAvatar:s,init:c,sendCode:l,login:u,logout:d,refreshToken:f,clearAuth:h}});var j=`modulepreload`,M=function(e){return`/`+e},N={};const P=function(e,t,n){let r=Promise.resolve();if(t&&t.length>0){let e=document.getElementsByTagName(`link`),i=document.querySelector(`meta[property=csp-nonce]`),a=i?.nonce||i?.getAttribute(`nonce`);function o(e){return Promise.all(e.map(e=>Promise.resolve(e).then(e=>({status:`fulfilled`,value:e}),e=>({status:`rejected`,reason:e}))))}r=o(t.map(t=>{if(t=M(t,n),t in N)return;N[t]=!0;let r=t.endsWith(`.css`),i=r?`[rel="stylesheet"]`:``;if(n)for(let n=e.length-1;n>=0;n--){let i=e[n];if(i.href===t&&(!r||i.rel===`stylesheet`))return}else if(document.querySelector(`link[href="${t}"]${i}`))return;let o=document.createElement(`link`);if(o.rel=r?`stylesheet`:j,r||(o.as=`script`),o.crossOrigin=``,o.href=t,a&&o.setAttribute(`nonce`,a),document.head.appendChild(o),r)return new Promise((e,n)=>{o.addEventListener(`load`,e),o.addEventListener(`error`,()=>n(Error(`Unable to preload CSS for ${t}`)))})}))}function i(e){let t=new Event(`vite:preloadError`,{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return r.then(t=>{for(let e of t||[])e.status===`rejected`&&i(e.reason);return e().catch(i)})};var F=c({history:u(),routes:[{path:`/`,component:()=>P(()=>import(`./WordLayout-D0VH2a69.js`),__vite__mapDeps([0,1,2,3,4,5,6,7,8])),meta:{requiresAuth:!0},children:[{path:``,redirect:`/words/learn`},{path:`/words/learn`,name:`WordLearn`,component:()=>P(()=>import(`./WordLearn-aDvHliN4.js`),__vite__mapDeps([9,10,1,2,3,4,5,6,7,11])),meta:{title:`单词学习`,requiresAuth:!0}},{path:`/words/manage`,name:`WordManage`,component:()=>P(()=>import(`./WordManage-D8zVGHJw.js`),__vite__mapDeps([12,10,3,2,4,5,6,7,13])),meta:{title:`添加单词`,requiresAuth:!0}},{path:`/words/review`,name:`WordReview`,component:()=>P(()=>import(`./WordReview-DJgxGtp1.js`),__vite__mapDeps([14,10,2,3,4,5,6,7,15])),meta:{title:`单词列表`,requiresAuth:!0}}]},{path:`/login`,name:`Login`,component:()=>P(()=>import(`./Login-DhRWoI2Z.js`),__vite__mapDeps([16,2,3,4,5,6,7,17])),meta:{title:`登录`,guest:!0}},{path:`/:pathMatch(.*)*`,redirect:`/words/learn`}]});F.beforeEach(async(e,t,n)=>{document.title=e.meta.title?`${e.meta.title} - 单词速记`:`单词速记`;let r=A();r.initialized||await r.init();let i=r.isLoggedIn;if(e.meta.requiresAuth&&!i){n({path:`/login`,query:{redirect:e.fullPath}});return}if(e.meta.guest&&i){n(`/`);return}n()});var I=F,L=(e,t)=>{let n=e.__vccOpts||e;for(let[e,r]of t)n[e]=r;return n},R={class:`pwa-install-prompt`},z={class:`prompt-header`},B={class:`prompt-icon`},V={class:`prompt-features`},H={class:`feature-item`},U={class:`feature-item`},W={class:`feature-item`},G={class:`prompt-actions`},K=L({__name:`PWAInstallPrompt`,setup(n){let i=g(!1),o=g(null),c=()=>window.matchMedia(`(display-mode: standalone)`).matches||window.navigator.standalone===!0,u=()=>{let e=localStorage.getItem(`pwa_install_dismissed`);if(!e)return!1;let t=parseInt(e,10);return Date.now()-t<10080*60*1e3},f=e=>{e.preventDefault(),o.value=e,!c()&&!u()&&setTimeout(()=>{i.value=!0},3e3)},p=async()=>{if(!o.value)return;o.value.prompt();let{outcome:e}=await o.value.userChoice;console.log(`PWA 安装结果:`,e),o.value=null,i.value=!1},_=()=>{i.value=!1,localStorage.setItem(`pwa_install_dismissed`,Date.now().toString())};return d(()=>{window.addEventListener(`beforeinstallprompt`,f),window.addEventListener(`appinstalled`,()=>{console.log(`PWA 已安装`),o.value=null,i.value=!1})}),e(()=>{window.removeEventListener(`beforeinstallprompt`,f)}),(e,n)=>{let o=s,c=t,u=l;return v(),r(u,{show:i.value,"onUpdate:show":n[0]||=e=>i.value=e,position:`bottom`,round:``},{default:y(()=>[m(`div`,R,[m(`div`,z,[m(`div`,B,[h(o,{name:`apps-o`,size:`32`,color:`#1989fa`})]),n[1]||=m(`div`,{class:`prompt-info`},[m(`h3`,null,`添加到主屏幕`),m(`p`,null,`获得更快的访问和更好的体验`)],-1),h(o,{name:`cross`,class:`close-btn`,onClick:_})]),m(`div`,V,[m(`div`,H,[h(o,{name:`fire-o`,color:`#07c160`}),n[2]||=m(`span`,null,`快速启动`,-1)]),m(`div`,U,[h(o,{name:`phone-o`,color:`#1989fa`}),n[3]||=m(`span`,null,`全屏体验`,-1)]),m(`div`,W,[h(o,{name:`shield-o`,color:`#ff976a`}),n[4]||=m(`span`,null,`离线可用`,-1)])]),m(`div`,G,[h(c,{block:``,round:``,onClick:_},{default:y(()=>[...n[5]||=[a(`稍后再说`,-1)]]),_:1}),h(c,{type:`primary`,block:``,round:``,onClick:p},{default:y(()=>[...n[6]||=[a(`立即安装`,-1)]]),_:1})])])]),_:1},8,[`show`])}}},[[`__scopeId`,`data-v-1d2ccb2e`]]),q={class:`loading-wrapper`},J=n({__name:`App`,setup(e){let t=A();return(e,n)=>{let r=S(`router-view`),o=b,s=x;return v(),w(i,null,[h(r),h(s,{show:C(t).loading,class:`global-loading`},{default:y(()=>[m(`div`,q,[h(o,{color:`#1989fa`,size:`40`,vertical:``},{default:y(()=>[...n[0]||=[a(`加载中...`,-1)]]),_:1})])]),_:1},8,[`show`]),h(K)],64)}}});J.use(o()),J.use(I),J.mount(`#app`);export{A as n,D as r,L as t};